<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>搜索结果 - 旅游资讯平台</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Element UI -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/search.css">
</head>
<body>
    <div id="searchApp">
        <!-- 导航栏 -->
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top shadow-sm">
            <div class="container">
                <a class="navbar-brand d-flex align-items-center" href="../index.html">
                    <i class="fas fa-globe-asia text-primary me-2"></i>
                    <span>旅游资讯</span>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarContent">
                    <div class="search-box">
                        <el-input
                            v-model="searchQuery"
                            placeholder="搜索目的地、酒店、攻略..."
                            prefix-icon="el-icon-search"
                            clearable
                            @keyup.enter.native="handleSearch"
                            @clear="clearSearch"
                            class="search-input">
                            <el-select
                                v-model="filters.type"
                                slot="append"
                                placeholder="全部"
                                style="width: 110px">
                                <el-option label="全部" value="all">
                                    <i class="fas fa-globe-asia me-2"></i>全部
                                </el-option>
                                <el-option label="目的地" value="destination">
                                    <i class="fas fa-map-marker-alt me-2"></i>目的地
                                </el-option>
                                <el-option label="酒店" value="hotel">
                                    <i class="fas fa-hotel me-2"></i>酒店
                                </el-option>
                                <el-option label="攻略" value="guide">
                                    <i class="fas fa-book me-2"></i>攻略
                                </el-option>
                            </el-select>
                        </el-input>
                        <!-- 搜索建议下拉框 -->
                        <div class="search-suggestions" v-show="showSuggestions && searchSuggestions.length > 0">
                            <el-card shadow="never" class="suggestions-card">
                                <div v-for="suggestion in searchSuggestions" 
                                     :key="suggestion"
                                     class="suggestion-item"
                                     @click="selectSuggestion(suggestion)">
                                    <i class="el-icon-search"></i>
                                    <span>{{suggestion}}</span>
                                </div>
                            </el-card>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- 主要内容区 -->
        <main class="container-fluid mt-5 pt-4">
            <!-- 热门搜索和搜索历史 -->
            <div class="search-history-section">
                <div class="row">
                    <div class="col-md-6">
                        <h6>
                            <i class="fas fa-fire text-danger me-2"></i>
                            热门搜索
                        </h6>
                        <div class="tag-cloud">
                            <span v-for="item in hotSearches" 
                                  :key="item"
                                  @click="searchQuery = item; handleSearch()"
                                  class="tag-item">
                                {{item}}
                            </span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6>
                            <i class="fas fa-history text-secondary me-2"></i>
                            搜索历史
                        </h6>
                        <div class="tag-cloud">
                            <span v-for="item in searchHistory" 
                                  :key="item"
                                  class="tag-item">
                                <span @click="searchQuery = item; handleSearch()">{{item}}</span>
                                <i class="fas fa-times" @click.stop="removeFromHistory(item)"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- 左侧筛选栏 -->
                <div class="col-lg-3">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title mb-4">搜索筛选</h5>
                            
                            <!-- 分类筛选 -->
                            <div class="filter-section">
                                <h6>分类</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" v-model="filters.type" 
                                           value="all" id="typeAll">
                                    <label class="form-check-label" for="typeAll">全部</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" v-model="filters.type" 
                                           value="destination" id="typeDestination">
                                    <label class="form-check-label" for="typeDestination">目的地</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" v-model="filters.type" 
                                           value="hotel" id="typeHotel">
                                    <label class="form-check-label" for="typeHotel">酒店</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" v-model="filters.type" 
                                           value="guide" id="typeGuide">
                                    <label class="form-check-label" for="typeGuide">攻略</label>
                                </div>
                            </div>

                            <!-- 设施筛选 -->
                            <div class="filter-section" v-if="filters.type === 'hotel'">
                                <h6>设施服务</h6>
                                <el-checkbox-group v-model="filters.facilities">
                                    <el-checkbox v-for="facility in facilityOptions"
                                               :key="facility.value"
                                               :label="facility.value">
                                        {{facility.label}}
                                    </el-checkbox>
                                </el-checkbox-group>
                            </div>

                            <!-- 评分筛选 -->
                            <div class="filter-section">
                                <h6>最低评分</h6>
                                <el-rate v-model="filters.rating" :colors="['#ffa500','#ffa500','#ffa500']"></el-rate>
                            </div>

                            <!-- 价格筛选 -->
                            <div class="filter-section">
                                <h6>价格区间</h6>
                                <el-slider v-model="filters.priceRange" range :min="0" :max="10000" 
                                         :step="100"></el-slider>
                                <div class="price-range-text">
                                    <span>¥{{filters.priceRange[0]}}</span>
                                    <span>¥{{filters.priceRange[1]}}</span>
                                </div>
                            </div>

                            <!-- 天气信息 -->
                            <div class="filter-section" v-if="weatherInfo">
                                <h6><i class="fas fa-cloud-sun"></i> 当地天气</h6>
                                <div class="weather-info">
                                    <div class="current-weather">
                                        <span class="temperature">{{weatherInfo.temperature}}°C</span>
                                        <span class="weather-desc">{{weatherInfo.description}}</span>
                                    </div>
                                    <div class="weather-suggestions" v-if="weatherSuggestions">
                                        <div v-for="suggestion in weatherSuggestions" 
                                             class="suggestion-item">
                                            <i class="fas fa-info-circle"></i>
                                            {{suggestion}}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 数据统计图表 -->
                            <div class="filter-section">
                                <h6>搜索统计</h6>
                                <div id="searchStats" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右侧搜索结果 -->
                <div class="col-lg-9">
                    <!-- 结果统计和排序 -->
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div class="results-count">
                            找到 <span class="text-primary">{{totalResults}}</span> 个相关结果
                        </div>
                        <div class="sort-options">
                            <select class="form-select" v-model="sortBy">
                                <option value="relevance">相关度</option>
                                <option value="rating">评分</option>
                                <option value="price-asc">价格从低到高</option>
                                <option value="price-desc">价格从高到低</option>
                                <option value="distance" v-if="userLocation">距离最近</option>
                            </select>
                        </div>
                    </div>

                    <!-- 特别活动提醒 -->
                    <div class="special-events mb-4" v-if="specialEvents.length > 0">
                        <div class="alert alert-info">
                            <h6><i class="fas fa-star"></i> 特别活动</h6>
                            <div class="event-list">
                                <div v-for="event in specialEvents" :key="event.id" class="event-item">
                                    <span class="event-title">{{event.title}}</span>
                                    <span class="event-date">{{event.date}}</span>
                                    <span class="event-price">¥{{event.price}}</span>
                                    <el-button size="small" type="primary" 
                                             :disabled="event.limitedQuota">
                                        立即预订
                                    </el-button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 搜索结果列表 -->
                    <div class="search-results" v-loading="loading">
                        <div class="card mb-3 search-result-item" v-for="item in resultsWithDistance" :key="item.id">
                            <div class="row g-0">
                                <div class="col-md-4 position-relative">
                                    <img :src="item.image" class="img-fluid rounded-start h-100" 
                                         :alt="item.title" style="object-fit: cover;">
                                    <div class="favorite-btn" @click="toggleFavorite(item)">
                                        <i class="fas" :class="{'fa-heart text-danger': isFavorite(item.id), 'fa-heart-o': !isFavorite(item.id)}"></i>
                                    </div>
                                </div>
                                <div class="col-md-8">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <h5 class="card-title">{{item.title}}</h5>
                                            <span class="badge" :class="getTypeClass(item.type)">
                                                {{getTypeText(item.type)}}
                                            </span>
                                        </div>
                                        <p class="card-text">{{item.description}}</p>
                                        <div class="meta-info">
                                            <el-rate v-model="item.rating" disabled show-score></el-rate>
                                            <span class="price" v-if="item.price">¥{{item.price}}</span>
                                        </div>
                                        <div class="tags mt-2">
                                            <span class="badge bg-light text-dark me-2" 
                                                  v-for="tag in item.tags" :key="tag">
                                                {{tag}}
                                            </span>
                                        </div>
                                        <!-- 实时信息 -->
                                        <div class="real-time-info mt-3">
                                            <div class="crowd-level" v-if="item.type === 'destination'">
                                                <i class="fas fa-users"></i>
                                                人流量: {{getCrowdLevel(item.id).level}}
                                                <span class="wait-time">
                                                    预计等待: {{getCrowdLevel(item.id).wait}}
                                                </span>
                                            </div>
                                            <div class="distance" v-if="item.distance">
                                                <i class="fas fa-map-marker-alt"></i>
                                                距离: {{item.distance.toFixed(1)}}km
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 分页 -->
                        <nav v-if="totalPages > 1" class="mt-4">
                            <ul class="pagination justify-content-center">
                                <li class="page-item" :class="{disabled: currentPage === 1}">
                                    <a class="page-link" href="#" @click.prevent="handlePageChange(currentPage - 1)">
                                        上一页
                                    </a>
                                </li>
                                <li class="page-item" v-for="page in totalPages" :key="page"
                                    :class="{active: currentPage === page}">
                                    <a class="page-link" href="#" @click.prevent="handlePageChange(page)">
                                        {{page}}
                                    </a>
                                </li>
                                <li class="page-item" :class="{disabled: currentPage === totalPages}">
                                    <a class="page-link" href="#" @click.prevent="handlePageChange(currentPage + 1)">
                                        下一页
                                    </a>
                                </li>
                            </ul>
                        </nav>

                        <!-- 无结果提示 -->
                        <div v-if="results.length === 0 && !loading" class="text-center py-5">
                            <i class="fas fa-search fa-3x text-muted mb-3"></i>
                            <h5>未找到相关结果</h5>
                            <p class="text-muted">请尝试其他关键词或调整筛选条件</p>
                        </div>
                    </div>

                    <!-- 推荐内容 -->
                    <div class="recommendations mt-5" v-if="recommendations.length > 0">
                        <h5><i class="fas fa-thumbs-up"></i> 猜你喜欢</h5>
                        <div class="row">
                            <div class="col-md-4" v-for="item in recommendations" :key="item.id">
                                <div class="card recommendation-card">
                                    <img :src="item.image" class="card-img-top" :alt="item.title">
                                    <div class="card-body">
                                        <h6 class="card-title">{{item.title}}</h6>
                                        <p class="card-text small">{{item.description}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- 页脚 -->
        <footer class="footer mt-5 py-5 bg-dark text-light">
            <div class="container">
                <div class="row">
                    <!-- 网站信 -->
                    <div class="col-md-4 mb-4">
                        <h5 class="mb-3">关于我们</h5>
                        <p class="text-muted">旅游资讯平台致力于为用户提供最全面的旅游信息和最优质的旅行服务，让每一次旅行都充满精彩。</p>
                        <div class="social-links">
                            <a href="#" class="text-light me-3"><i class="fab fa-weixin"></i></a>
                            <a href="#" class="text-light me-3"><i class="fab fa-weibo"></i></a>
                            <a href="#" class="text-light"><i class="fab fa-qq"></i></a>
                        </div>
                    </div>
                    
                    <!-- 快速链接 -->
                    <div class="col-md-2 mb-4">
                        <h5 class="mb-3">快速链接</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2"><a href="../index.html" class="text-muted">首页</a></li>
                            <li class="mb-2"><a href="destination.html" class="text-muted">目的地</a></li>
                            <li class="mb-2"><a href="travel-guide.html" class="text-muted">旅游攻略</a></li>
                            <li class="mb-2"><a href="about.html" class="text-muted">关于我们</a></li>
                        </ul>
                    </div>
                    
                    <!-- 热门目的地 -->
                    <div class="col-md-3 mb-4">
                        <h5 class="mb-3">热门目的地</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2"><a href="#" class="text-muted">北京</a></li>
                            <li class="mb-2"><a href="#" class="text-muted">上海</a></li>
                            <li class="mb-2"><a href="#" class="text-muted">成都</a></li>
                            <li class="mb-2"><a href="#" class="text-muted">三亚</a></li>
                        </ul>
                    </div>
                    
                    <!-- 联系方式 -->
                    <div class="col-md-3 mb-4">
                        <h5 class="mb-3">联系我们</h5>
                        <ul class="list-unstyled">
                            <li class="mb-2 text-muted"><i class="fas fa-phone me-2"></i>400-123-4567</li>
                            <li class="mb-2 text-muted"><i class="fas fa-envelope me-2"></i>contact@travel.com</li>
                            <li class="mb-2 text-muted"><i class="fas fa-map-marker-alt me-2"></i>北京市朝阳区</li>
                        </ul>
                    </div>
                </div>
                
                <!-- 版权信息 -->
                <div class="row mt-4">
                    <div class="col-12">
                        <hr class="bg-secondary">
                        <p class="text-muted text-center mb-0">
                            © 2024 旅游资讯平台 版权所有 | 京ICP备12345678号
                        </p>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
    <!-- Element UI -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <!-- ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.2.2/dist/echarts.min.js"></script>
    <!-- Custom JS -->
    <script src="../js/search.js"></script>
</body>
</html> 